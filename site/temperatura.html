<html>

<head>
    <link rel="stylesheet" href="styles.css">
    <title>Temperatura</title>
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.1.0/paho-mqtt.min.js"
        type="text/javascript"></script>

</head>

<body>
    <div id="header">
        <h1>
            IF Resources
        </h1>
        <a href="index.html">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/54/Instituto_Federal_Marca_2015.svg/640px-Instituto_Federal_Marca_2015.svg.png"
                alt="Logo Instituto Federal" width="128" height="168">
        </a>
    </div>
    <div id="temperatura">
        <script>
            // Conexão com o broker MQTT
            var broker = 'broker.hivemq.com';
            var port = 1883;
            var clientId = 'tcctermostato-esp32-0800313131';
            var topic = 'tcc_termostato_temp';

            // Criando um cliente MQTT
            var client = new Paho.MQTT.Client(broker, port, clientId);

            // Definindo as funções de retorno de chamada
            client.onConnectionLost = onConnectionLost;
            client.onMessageArrived = onMessageArrived;

            // Conectando-se ao broker MQTT
            client.connect({ onSuccess: onConnect });

            // Quando a conexão é estabelecida
            function onConnect() {
                console.log('Conectado ao broker MQTT');

                // Subscrevendo a um tópico
                client.subscribe(topic);
            }

            // Quando ocorre uma perda de conexão
            function onConnectionLost(responseObject) {
                if (responseObject.errorCode !== 0) {
                    console.log('Conexão perdida: ' + responseObject.errorMessage);
                }
            }

            // Quando uma mensagem é recebida
            function onMessageArrived(message) {
                console.log('Mensagem recebida: ' + message.payloadString);
                // Exibindo a mensagem no contêiner
                var messageContainer = document.getElementById('message-container');
                messageContainer.innerHTML = message.payloadString;
            }
        </script>
    </div>
    <div id="rodape">
        <h3>
            Gabriel Sales </br> Michael Monteiro de Lima </br></br> 2020.1 / 2023.1(se Deus quiser)
        </h3>
    </div>

</body>

</html>